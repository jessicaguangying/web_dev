<!DOCTPYE html>
<html lang="en">
<head>
	<meta charset="utf=8">
	<title></title>
	<style>
		div{width:100px; height:100px; border:1px solid black;}
	</style>
</head>
<body>
	<script>
	/*
		var len;    // 因为声明的多个函数都需要数据长度，所以把len设置成为全局变量
		var arr = [22,4,7,18,1,23,14,5,16]
		function buildMaxHeap(arr) {   // 建立大顶堆
			len = arr.length;
			for (var i = Math.floor(len / 2); i >= 0; i--) {
				heapify(arr, i);	
				console.log(arr);
			}
		}
		function heapify(arr, i) {     // 堆调整
			var left = 2 * i + 1,
				right = 2 * i + 2,
				largest = i;
			if (left < len && arr[left] > arr[largest]) {
				largest = left;
			}

			if (right < len && arr[right] > arr[largest]) {
				largest = right;
			}

			if (largest != i) {
				swap(arr, i, largest);
				heapify(arr, largest);
			}
		}

		function swap(arr, i, j) {
			var temp = arr[i];
			arr[i] = arr[j];
			arr[j] = temp;
		}

		function heapSort(arr) {
			buildMaxHeap(arr);
			for (var i = arr.length - 1; i > 0; i--) {
				swap(arr, 0, i);
				len--;
				heapify(arr, 0);
			}
			return arr;
		}	
		document.write(heapSort(arr));
	
		
		var len;
		function buildMaxHeap(arr){
			len = arr.length;
			for(i = Math.floor(len / 2); i >= 0; i--){
				heapify(arr,i);
			}
		}
		function heapify(arr,i){
			var left = 2 * i + 1;
				right = 2 * i + 2;
				largest = i;
			if (left < len && arr[left] > arr[largest]){
				largest = left;
			}
			if (right < len && arr[right] > arr[largest]){
				largest = right;
			}
			if (largest != i){
				swap(arr,i,largest);
				heapify(arr,largest);	
			}
		}
		function swap(arr,i,j){
			var temp = arr[i];
				arr[i] = arr[j];
				arr[j] = temp;
		}
		function heapSort(arr){
			buildMaxHeap(arr);
			for(i = arr.length - 1; i > 0; i--){
				swap(arr,0, i);
				len--;
				heapify(arr,0);
			}
		return arr;
		}
		var arr = [22,4,7,18,1,23,14,5,16]
		document.write(heapSort(arr));
		
		
		var len;
		function buildMaxHeap(arr){
			len = arr.length;
			for(i = Math.floor(len / 2); i >= 0; i--){
				heapify(arr,i);   //[23, 18, 22, 16, 1, 7, 14, 5, 4]
				console.log(arr);
			}
		}
		function heapify(arr,i){
			var left = 2 * i + 1;
				right = 2 * i + 2;
				largest = i;
			if (left < len && arr[left] > arr[largest]){
				largest = left;
			}
			if (right < len && arr[right] > arr[largest]){
				largest = right;
			}
			if(largest != i){
				swap(arr,i,largest);
				heapify(arr,largest);
			}
		}
		function swap(arr,i,j){
			var temp = arr[i];
				arr[i] = arr[j];
				arr[j] = temp;
		}
		function heapSort(arr){
			buildMaxHeap(arr);
			for(i = arr.length -1; i > 0; i--){
				swap(arr,0,i);
				console.log(arr);
				console.log(i);
				len--;
				heapify(arr,0);
				console.log(arr);
				
			}
		return arr;
		}
		var arr = [22,4,7,18,1,23,14,5,16]
		document.write(heapSort(arr));
		
		
		
		var len;
		function buildMaxHeap(arr){
			len = arr.length;
			for(i = Math.floor(len / 2); i >= 0; i--){
			heapify(arr,i);
			}
		}
		function heapify(arr,i){
			var left = 2 * i + 1;
				right = 2 * i +2;
				largest = i;
			if(left < len && arr[left] > arr[largest]){
				largest = left;
			}
			if(right < len && arr[right] > arr[largest]){
				largest = right;
			}
			if(largest != i){
				swap(arr,i,largest);
				heapify(arr,largest);
			}
		}
		function swap(arr, i ,j){
			var temp = arr[i];
			     arr[i] = arr[j];
				 arr[j] = temp;
		}
		function heapSort(arr){
			buildMaxHeap(arr);
			for(i = arr.length - 1; i > 0; i--){
				swap(arr,0,i);
				len--;
				heapify(arr,0);
			}
			return arr;
		}
		var arr = [22,4,7,18,1,23,14,5,16];
		document.write(heapSort(arr));
		*/
		
		var len;
		function buildMaxHeap(arr){
			len = arr.length;
			for(i = Math.floor(len /2); i >= 0; i--){
				heapify(arr,i);
			}
		}
		function heapify(arr,i){
			var left = 2 * i +1;
				right = 2 * i +2;
				largest = i;
			if(left < len && arr[left] > arr[largest]){
				largest = left;
			}
			if(right < len && arr[right] > arr[largest]){
				largest = right;
			}
			if(largest != i){
				swap(arr,i,largest);
				heapify(arr,largest);
			}
		}
		function swap(arr,i,j){
			var temp = arr[i];
				arr[i] = arr[j];
				arr[j] = temp;
		}
		function heapSort(arr){
			buildMaxHeap(arr);
			for(i = arr.length - 1; i > 0; i--){
			swap(arr,0,i)
			len--;
			heapify(arr,0);
			}
		return arr;
		}
		var arr = [22,4,7,18,2,23,14,5,16];
		document.write(heapSort(arr));
		
	</script>
</body>
<html>